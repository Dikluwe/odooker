<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador Odooker</title>
    <!-- Link para o arquivo CSS externo -->
    <link rel="stylesheet" href="odoo_setup_generator.css">

    <link rel="icon" type="image/png" href="/imagem/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/imagem/favicon.svg" />
    <link rel="shortcut icon" href="/imagem/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/imagem/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="odoocker" />
    <link rel="manifest" href="/imagem/site.webmanifest" />
</head>
<body>
    <!-- Container principal que centraliza todo o conte√∫do da aplica√ß√£o -->
    <div class="container">
        <!-- Cabe√ßalho com t√≠tulo e descri√ß√£o do gerador -->
        <div class="header">
            <h1>üõ† Gerador de Configura√ß√£o Odoo</h1>
            <p>Configure sua inst√¢ncia Odoo Community com seguran√ßa e facilidade</p>
        </div>
        
        <!-- Container do conte√∫do principal com wizard de configura√ß√£o -->
        <div class="content">
            <!-- Barra de progresso visual que mostra o avan√ßo nos 4 passos -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 25%;"></div>
            </div>
            
            <!-- =================================================================== -->
            <!-- PASSO 1: Configura√ß√µes B√°sicas do Projeto -->
            <!-- =================================================================== -->
            <div class="step active" id="step1">
                <div class="step-header">
                    <h2 class="step-title">üìã Configura√ß√µes B√°sicas</h2>
                    <p class="step-description">
                        Defina as configura√ß√µes fundamentais da sua inst√¢ncia Odoo: nome do projeto, vers√£o e portas de rede.
                    </p>
                </div>
                
                <!-- Layout em duas colunas para otimizar espa√ßo -->
                <div class="form-row">
                    <!-- Coluna 1: Nome do projeto - usado para nomenclatura de containers -->
                    <div class="form-col">
                        <label for="projectName">Nome do Projeto <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="projectName" 
                            placeholder="minha-empresa-odoo" 
                            required
                            pattern="^[a-z0-9][a-z0-9-]*[a-z0-9]$"
                        >
                        <div class="help-text">
                            Nome usado para containers e volumes. Apenas letras min√∫sculas, n√∫meros e h√≠fens.
                            N√£o pode come√ßar ou terminar com h√≠fen.
                        </div>
                    </div>
                    
                    <!-- Coluna 2: Vers√£o do Odoo - determina a imagem Docker -->
                    <div class="form-col">
                        <label for="odooVersion">Vers√£o do Odoo <span class="required">*</span></label>
                        <select id="odooVersion" required>
                            <option value="18.0">18.0 (Mais Recente)</option>
                            <option value="17.0" selected>17.0 (LTS - Recomendado)</option>
                            <option value="16.0">16.0 (Est√°vel)</option>
                        </select>
                        <div class="help-text">
                            Vers√£o 17.0 √© LTS (Long Term Support) - mais est√°vel para produ√ß√£o.
                        </div>
                    </div>
                </div>
                
                <!-- Segunda linha: Configura√ß√µes de rede - portas que ser√£o expostas -->
                <div class="form-row">
                    <!-- Porta principal do Odoo (interface web) -->
                    <div class="form-col">
                        <label for="httpPort">Porta HTTP <span class="required">*</span></label>
                        <input 
                            type="number" 
                            id="httpPort" 
                            value="8069" 
                            min="1024" 
                            max="65535" 
                            required
                        >
                        <div class="help-text">
                            Porta onde o Odoo ser√° acessado (ex: http://localhost:8069)
                        </div>
                    </div>
                    
                    <!-- Porta para comunica√ß√£o em tempo real (chat, notifica√ß√µes) -->
                    <div class="form-col">
                        <label for="chatPort">Porta Chat (Longpolling)</label>
                        <input 
                            type="number" 
                            id="chatPort" 
                            value="8072" 
                            min="1024" 
                            max="65535"
                        >
                        <div class="help-text">
                            Porta para recursos em tempo real como chat e notifica√ß√µes.
                        </div>
                    </div>
                </div>
                
                <!-- Campo opcional para dom√≠nio personalizado -->
                <div class="form-group">
                    <label for="domain">Dom√≠nio (opcional)</label>
                    <input 
                        type="text" 
                        id="domain" 
                        placeholder="meuodoo.exemplo.com.br"
                        pattern="^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}$"
                    >
                    <div class="help-text">
                        Deixe em branco se for usar apenas localmente. Ser√° usado para configura√ß√µes de email e SSL.
                    </div>
                </div>
            </div>
            
            <!-- =================================================================== -->
            <!-- PASSO 2: Configura√ß√µes do Banco de Dados PostgreSQL -->
            <!-- =================================================================== -->
            <div class="step" id="step2">
                <div class="step-header">
                    <h2 class="step-title">üóÑÔ∏è Configura√ß√µes do Banco de Dados</h2>
                    <p class="step-description">
                        Configure o PostgreSQL com credenciais seguras. As senhas s√£o geradas automaticamente com alta entropia.
                    </p>
                </div>
                
                <!-- Configura√ß√µes b√°sicas do banco: nome da base e usu√°rio -->
                <div class="form-row">
                    <div class="form-col">
                        <label for="dbName">Nome da Base de Dados <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="dbName" 
                            value="odoo" 
                            required
                            pattern="^[a-zA-Z][a-zA-Z0-9_]*$"
                        >
                        <div class="help-text">
                            Nome da database no PostgreSQL. Deve come√ßar com letra.
                        </div>
                    </div>
                    <div class="form-col">
                        <label for="dbUser">Usu√°rio do Banco <span class="required">*</span></label>
                        <input 
                            type="text" 
                            id="dbUser" 
                            value="odoo" 
                            required
                            pattern="^[a-zA-Z][a-zA-Z0-9_]*$"
                        >
                        <div class="help-text">
                            Usu√°rio PostgreSQL que o Odoo usar√° para conectar.
                        </div>
                    </div>
                </div>
                
                <!-- Campo de senha do banco com toggle de visibilidade -->
                <div class="form-group">
                    <label for="dbPassword">Senha do Banco <span class="required">*</span></label>
                    <div style="position: relative;">
                        <input 
                            type="password" 
                            id="dbPassword" 
                            placeholder="Ser√° gerada automaticamente" 
                            style="padding-right: 100px;"
                            required
                            minlength="12"
                        >
                        <!-- Bot√£o para alternar visibilidade da senha -->
                        <button 
                            type="button" 
                            class="toggle-password" 
                            data-field="dbPassword" 
                            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 14px; padding: 2px 4px;"
                        >
                            üëÅÔ∏è Mostrar
                        </button>
                    </div>
                    <!-- Bot√£o para gerar nova senha segura -->
                    <button 
                        type="button" 
                        class="btn btn-secondary" 
                        style="margin-top: 10px;" 
                        onclick="wizard.generatePasswords()"
                    >
                        üîÑ Gerar Senha Segura
                    </button>
                    <div class="help-text">
                        Senha do usu√°rio PostgreSQL. Gerada automaticamente com 24 caracteres seguros.
                    </div>
                </div>
                
                <!-- Campo de senha master do Odoo (para opera√ß√µes administrativas) -->
                <div class="form-group">
                    <label for="adminPassword">Senha Master do Odoo <span class="required">*</span></label>
                    <div style="position: relative;">
                        <input 
                            type="password" 
                            id="adminPassword" 
                            placeholder="Ser√° gerada automaticamente" 
                            style="padding-right: 100px;"
                            required
                            minlength="12"
                        >
                        <!-- Bot√£o para alternar visibilidade da senha master -->
                        <button 
                            type="button" 
                            class="toggle-password" 
                            data-field="adminPassword" 
                            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 14px; padding: 2px 4px;"
                        >
                            üëÅÔ∏è Mostrar
                        </button>
                    </div>
                    <div class="help-text">
                        Senha administrativa para criar/restaurar bancos de dados e opera√ß√µes sens√≠veis no Odoo.
                    </div>
                </div>
                
                <!-- Op√ß√£o para expor porta do PostgreSQL (apenas desenvolvimento) -->
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="enablePostgresPort"> 
                        Expor porta 5432 do PostgreSQL
                    </label>
                    <div class="help-text">
                        ‚ö†Ô∏è Recomendado apenas para desenvolvimento local. Permite acesso direto ao banco com ferramentas externas.
                        <strong>Desabilite em produ√ß√£o por seguran√ßa.</strong>
                    </div>
                </div>
            </div>
            
            <!-- =================================================================== -->
            <!-- PASSO 3: Performance e Recursos do Sistema -->
            <!-- =================================================================== -->
            <div class="step" id="step3">
                <div class="step-header">
                    <h2 class="step-title">‚ö° Performance e Recursos</h2>
                    <p class="step-description">
                        Configure os recursos do sistema para otimizar a performance baseado no seu ambiente e carga esperada.
                    </p>
                </div>
                
                <!-- Configura√ß√µes de workers (processos) e threads para jobs autom√°ticos -->
                <div class="form-row">
                    <div class="form-col">
                        <label for="workers">N√∫mero de Workers</label>
                        <select id="workers">
                            <option value="0">0 (Desenvolvimento - Thread √önico)</option>
                            <option value="2">2 Workers (Produ√ß√£o Leve)</option>
                            <option value="4" selected>4 Workers (Recomendado)</option>
                            <option value="6">6 Workers (Alto Tr√°fego)</option>
                            <option value="8">8 Workers (Muito Alto Tr√°fego)</option>
                        </select>
                        <div class="help-text">
                            Workers s√£o processos separados. 0 = modo single-thread para desenvolvimento.
                            Para produ√ß√£o, use 2+ workers baseado no n√∫mero de CPUs dispon√≠veis.
                        </div>
                    </div>
                    <div class="form-col">
                        <label for="cronThreads">Threads Cron</label>
                        <select id="cronThreads">
                            <option value="1">1 Thread</option>
                            <option value="2" selected>2 Threads (Recomendado)</option>
                            <option value="4">4 Threads</option>
                        </select>
                        <div class="help-text">
                            Threads para executar tarefas autom√°ticas (emails, relat√≥rios, sincroniza√ß√µes).
                        </div>
                    </div>
                </div>
                
                <!-- Configura√ß√µes de mem√≥ria e n√≠vel de logging -->
                <div class="form-row">
                    <div class="form-col">
                        <label for="memoryLimit">Limite de Mem√≥ria</label>
                        <select id="memoryLimit">
                            <option value="1">1 GB (M√≠nimo - Teste)</option>
                            <option value="2" selected>2 GB (Recomendado)</option>
                            <option value="4">4 GB (Empresas M√©dias)</option>
                            <option value="8">8 GB (Empresas Grandes)</option>
                        </select>
                        <div class="help-text">
                            Limite de mem√≥ria RAM para o container Odoo. Ajuste baseado na capacidade do servidor.
                        </div>
                    </div>
                    <div class="form-col">
                        <label for="logLevel">N√≠vel de Log</label>
                        <select id="logLevel">
                            <option value="error">Error (Produ√ß√£o - M√≠nimo)</option>
                            <option value="warn">Warning (Produ√ß√£o)</option>
                            <option value="info" selected>Info (Recomendado)</option>
                            <option value="debug">Debug (Desenvolvimento)</option>
                        </select>
                        <div class="help-text">
                            Controla a verbosidade dos logs. Info √© bom para monitoramento, Debug para desenvolvimento.
                        </div>
                    </div>
                </div>
                
                <!-- Servi√ßos adicionais: Redis para cache e Nginx para proxy -->
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="enableRedis" checked> 
                        Habilitar Redis (Cache/Sess√µes)
                    </label>
                    <div class="help-text">
                        ‚úÖ <strong>Altamente recomendado.</strong> Redis melhora significativamente a performance 
                        ao armazenar cache de sess√µes e dados tempor√°rios em mem√≥ria.
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="enableNginx"> 
                        Habilitar Nginx (Proxy Reverso)
                    </label>
                    <div class="help-text">
                        Recomendado para produ√ß√£o. Nginx oferece melhor handling de arquivos est√°ticos, 
                        compress√£o, SSL/TLS e balanceamento de carga. Configure SSL separadamente.
                    </div>
                </div>
            </div>
            
            <!-- =================================================================== -->
            <!-- PASSO 4: Revis√£o Final e Gera√ß√£o dos Arquivos -->
            <!-- =================================================================== -->
            <div class="step" id="step4">
                <div class="step-header">
                    <h2 class="step-title">‚úÖ Revis√£o e Gera√ß√£o</h2>
                    <p class="step-description">
                        Revise suas configura√ß√µes, veja os comandos necess√°rios e gere todos os arquivos de configura√ß√£o.
                    </p>
                </div>
                
                <!-- Container para o resumo autom√°tico da configura√ß√£o -->
                <div id="reviewContent">
                    <!-- Ser√° populado dinamicamente pelo JavaScript -->
                </div>
                
                <!-- Preview dos comandos Docker que o usu√°rio precisar√° executar -->
                <div id="dockerCommands" style="background: #2d3748; color: #e2e8f0; border-radius: 10px; padding: 20px; margin: 20px 0;">
                    <h3 style="color: #4a90e2; margin-bottom: 15px;">üê≥ Comandos Docker para Executar</h3>
                    <div style="font-family: monospace; font-size: 0.9rem;">
                        <div style="margin-bottom: 10px;"># 1. Navegar para o diret√≥rio do projeto</div>
                        <div style="color: #90cdf4; margin-bottom: 15px;">cd meu-projeto-odoo</div>
                        
                        <div style="margin-bottom: 10px;"># 2. Construir e iniciar os containers</div>
                        <div style="color: #90cdf4; margin-bottom: 15px;">docker-compose up -d</div>
                        
                        <div style="margin-bottom: 10px;"># 3. Verificar se tudo est√° funcionando</div>
                        <div style="color: #90cdf4; margin-bottom: 15px;">docker-compose ps</div>
                        
                        <div style="margin-bottom: 10px;"># 4. Ver logs do Odoo (se necess√°rio)</div>
                        <div style="color: #90cdf4; margin-bottom: 15px;">docker-compose logs -f odoo</div>
                        
                        <div style="margin-bottom: 10px;"># 5. Parar os containers</div>
                        <div style="color: #90cdf4;">docker-compose down</div>
                    </div>
                </div>
                
                <!-- Dicas importantes de seguran√ßa e boas pr√°ticas -->
                <div class="security-tips">
                    <h3>üîí Dicas de Seguran√ßa e Boas Pr√°ticas</h3>
                    <ul>
                        <li><strong>Senhas:</strong> As senhas foram geradas automaticamente com alta entropia (24 caracteres)</li>
                        <li><strong>Arquivo .env:</strong> Mantenha o arquivo .env seguro e nunca o commite no git</li>
                        <li><strong>Backup:</strong> Configure backups autom√°ticos do PostgreSQL para n√£o perder dados</li>
                        <li><strong>SSL/TLS:</strong> Para produ√ß√£o, configure certificados SSL no Nginx</li>
                        <li><strong>Firewall:</strong> Configure firewall para expor apenas as portas necess√°rias</li>
                        <li><strong>Monitoramento:</strong> Use <code>docker-compose logs</code> para monitorar a aplica√ß√£o</li>
                        <li><strong>Atualiza√ß√µes:</strong> Mantenha as imagens Docker atualizadas regularmente</li>
                    </ul>
                </div>
                
                <!-- Bot√£o para baixar todos os arquivos como ZIP -->
                <div style="text-align: center; margin: 30px 0;">
                    <button 
                        class="btn btn-success" 
                        id="downloadZipBtn" 
                        onclick="wizard.downloadAsZip()"
                        style="font-size: 1.1rem; padding: 15px 30px;"
                    >
                        üì¶ Baixar Todos os Arquivos (ZIP)
                    </button>
                    <div class="help-text" style="margin-top: 10px;">
                        Baixa um arquivo ZIP com todos os arquivos de configura√ß√£o e estrutura de pastas organizada.
                    </div>
                </div>
                
                <!-- Container para os arquivos gerados (exibi√ß√£o individual) -->
                <div class="output-container" id="outputContainer">
                    <!-- Ser√° populado dinamicamente com os arquivos gerados -->
                </div>
            </div>
            
            <!-- =================================================================== -->
            <!-- Bot√µes de Navega√ß√£o do Wizard -->
            <!-- =================================================================== -->
            <div class="buttons">
                <!-- Bot√£o Anterior (oculto no primeiro passo) -->
                <button 
                    class="btn btn-secondary" 
                    id="prevBtn" 
                    onclick="wizard.previousStep()" 
                    style="display: none;"
                >
                    ‚¨ÖÔ∏è Anterior
                </button>
                
                <!-- Indicador do passo atual -->
                <div>Passo <span id="currentStep">1</span> de 4</div>
                
                <!-- Bot√£o Pr√≥ximo/Gerar (muda texto no √∫ltimo passo) -->
                <button 
                    class="btn btn-primary" 
                    id="nextBtn" 
                    onclick="wizard.nextStep()"
                >
                    Pr√≥ximo ‚û°Ô∏è
                </button>
            </div>
        </div>
    </div>

    <!-- Inclus√£o do arquivo JavaScript principal -->
    <script src="odoo_setup_generator.js"></script>
</body>
</html>
